See ../nvim-claude for a possible reference implementation for the features that I'm missing
